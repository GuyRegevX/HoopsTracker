-- Insert test data
INSERT INTO leagues (league_id, name, country) VALUES 
('00000000-0000-0000-0000-000000000001', 'NBA', 'USA');

INSERT INTO seasons (season_id, name, start_date, end_date, active) VALUES
('00000000-0000-0000-0000-000000000101', '2023/2024', '2023-10-01', '2024-04-30', TRUE);

INSERT INTO teams (team_id, name, league_id, country, city, division, conference, arena, founded_year) VALUES
('00000000-0000-0000-0000-000000000201', 'Los Angeles Lakers', '00000000-0000-0000-0000-000000000001', 'USA', 
'Los Angeles', 'Pacific', 'Western', 'Crypto.com Arena', 1947);

INSERT INTO players (player_id, name, team_id, jersey_number, position, active) VALUES
('00000000-0000-0000-0000-000000000501', 'LeBron James', '00000000-0000-0000-0000-000000000201', '23', 'SF', TRUE);

INSERT INTO games (game_id, game_date, season_id, league_id, home_team_id, away_team_id, start_time, state) VALUES
('00000000-0000-0000-0000-000000000301', '2024-01-15', '00000000-0000-0000-0000-000000000101', 
 '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000201', 
 '00000000-0000-0000-0000-000000000201', '19:30:00', 'COMPLETED');

-- Insert test stats for completed game
INSERT INTO player_stat_events (event_id, player_id, game_id, team_id, timestamp, stat_type, stat_value) VALUES
-- Points
('00000000-0000-0000-0000-000000000401', '00000000-0000-0000-0000-000000000501', 
 '00000000-0000-0000-0000-000000000301', '00000000-0000-0000-0000-000000000201',
 '2024-01-15 23:35:00+00:00', 'point', 118),
-- Assists
('00000000-0000-0000-0000-000000000402', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000301', '00000000-0000-0000-0000-000000000201',
 '2024-01-15 23:35:00+00:00', 'assist', 27),
-- Rebounds
('00000000-0000-0000-0000-000000000403', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000301', '00000000-0000-0000-0000-000000000201',
 '2024-01-15 23:35:00+00:00', 'rebound', 46),
-- Steals
('00000000-0000-0000-0000-000000000404', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000301', '00000000-0000-0000-0000-000000000201',
 '2024-01-15 23:35:00+00:00', 'steal', 9),
-- Blocks
('00000000-0000-0000-0000-000000000405', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000301', '00000000-0000-0000-0000-000000000201',
 '2024-01-15 23:35:00+00:00', 'block', 6),
-- Turnovers
('00000000-0000-0000-0000-000000000406', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000301', '00000000-0000-0000-0000-000000000201',
 '2024-01-15 23:35:00+00:00', 'turnover', 12),
-- Minutes
('00000000-0000-0000-0000-000000000407', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000301', '00000000-0000-0000-0000-000000000201',
 '2024-01-15 23:35:00+00:00', 'minutes_played', 243);

-- Insert a live game for testing latest stats
INSERT INTO games (game_id, game_date, season_id, league_id, home_team_id, away_team_id, start_time, state) VALUES
('00000000-0000-0000-0000-000000000302', '2024-01-16', '00000000-0000-0000-0000-000000000101', 
 '00000000-0000-0000-0000-000000000001', '00000000-0000-0000-0000-000000000201', 
 '00000000-0000-0000-0000-000000000201', '19:30:00', 'IN_PROGRESS');

-- Insert live game stats
INSERT INTO player_stat_events (event_id, player_id, game_id, team_id, timestamp, stat_type, stat_value) VALUES
-- Points (live game)
('00000000-0000-0000-0000-000000000411', '00000000-0000-0000-0000-000000000501', 
 '00000000-0000-0000-0000-000000000302', '00000000-0000-0000-0000-000000000201',
 '2024-01-16 23:35:00+00:00', 'point', 132),
-- Assists (live game)
('00000000-0000-0000-0000-000000000412', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000302', '00000000-0000-0000-0000-000000000201',
 '2024-01-16 23:35:00+00:00', 'assist', 33),
-- Rebounds (live game)
('00000000-0000-0000-0000-000000000413', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000302', '00000000-0000-0000-0000-000000000201',
 '2024-01-16 23:35:00+00:00', 'rebound', 54),
-- Steals (live game)
('00000000-0000-0000-0000-000000000414', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000302', '00000000-0000-0000-0000-000000000201',
 '2024-01-16 23:35:00+00:00', 'steal', 11),
-- Blocks (live game)
('00000000-0000-0000-0000-000000000415', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000302', '00000000-0000-0000-0000-000000000201',
 '2024-01-16 23:35:00+00:00', 'block', 10),
-- Turnovers (live game)
('00000000-0000-0000-0000-000000000416', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000302', '00000000-0000-0000-0000-000000000201',
 '2024-01-16 23:35:00+00:00', 'turnover', 10),
-- Minutes (live game)
('00000000-0000-0000-0000-000000000417', '00000000-0000-0000-0000-000000000501',
 '00000000-0000-0000-0000-000000000302', '00000000-0000-0000-0000-000000000201',
 '2024-01-16 23:35:00+00:00', 'minutes_played', 247);

-- Refresh materialized views
REFRESH MATERIALIZED VIEW CONCURRENTLY team_session_avg;
REFRESH MATERIALIZED VIEW CONCURRENTLY player_session_avg; 